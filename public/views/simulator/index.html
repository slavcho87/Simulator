<div ng-init="loadData()">    
        <div id="wrapper" >
            <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="#/">Simulator</a>
                </div>

                <div class="collapse navbar-collapse navbar-ex1-collapse">
                    <ul class="nav navbar-nav side-nav">
                        <li><a href="#/map"><i class="fa fa-map-marker"></i> Maps</a></li>
                        <li class="active"><a href="#/simulator"><i class="fa fa-globe"></i> Simulation</a></li>
                        <li><a href="#/settings"><i class="fa fa-cog"></i> Settings</a></li>
                        <li><a href="#/profile"><i class="fa fa-edit"></i> Profile</a></li>
                    </ul>
                </div>		
            </nav>
            --> {{msg}} --
            <div id="page-wrapper" ng-hide="simulationDataLoaded">
                {{info}}
                <div class="progress progress-striped active">
                    <div class="progress-bar" role="progressbar"
                         aria-valuemin="0" aria-valuemax="100"
                         style="width: 90%">
                        <span class="sr-only">45% completado</span>
                    </div>
                </div>
            </div>
            
            <div id="page-wrapper" ng-show="simulationDataLoaded">		                
                <div class="row">    
                    <div id="mapa" class="mapa col-sm-8">
                    </div>
                        <script src="javascripts/socketsIO/socket.io.js"></script>
                        <script>
                            var socket = io();
                        </script>
                        <script type="text/javascript">
                            var overlayList = {};
                            
                            var map = new ol.Map({
                                target: 'mapa',
                                layers: [
                                    new ol.layer.Tile({
                                        source: new ol.source.MapQuest({layer: 'osm'})
                                    })
                                ],
                                view: new ol.View({
                                    center: ol.proj.transform([-0.88824, 41.66991], 'EPSG:4326', 'EPSG:3857'),
                                    zoom: 15
                                }),
                                controls: ol.control.defaults().extend([
                                    new ol.control.FullScreen()
                                ])
                            });
                    
                            map.on('singleclick', function(evt) { 
                                /*map.getOverlays().getArray().slice(0).forEach(function(overlay) {
                                    if(overlay.getElement()[0].name==getUser()._id){
                                        map.removeOverlay(overlay);
                                    }
                                });
                                
                                map.addOverlay(new ol.Overlay({
                                    position: evt.coordinate,
                                    element: $('<img src="'+getImg()+'" class="img-circle" name="'+getUser()._id+'">')
                                    .css({marginTop: '-50%', marginLeft: '-50%', width: '40px', height: '40px', cursor: 'pointer'})
                                    .tooltip({title: 'Hello, world!', trigger: 'click'})
                                }));*/
                                
                                if(overlayList['user']){
                                    console.log(overlayList['user']);
                                    map.removeOverlay(overlayList['user']);                                
                                }

                                overlayList['user'] = new ol.Overlay({
                                    position: evt.coordinate,
                                    element: $('<img src="'+getImg()+'" class="img-circle" name="'+getUser()._id+'">')
                                    .css({marginTop: '-50%', marginLeft: '-50%', width: '40px', height: '40px', cursor: 'pointer'})
                                    .tooltip({title: 'Hello, world!', trigger: 'click'})
                                });
                                                                
                                map.addOverlay(overlayList['user']);
                                
                                
                                
                                /*var lista = map.getOverlays().getArray();
                                
                                for(index in lista){
                                    console.log(lista[index].getElement()[0].name);
                                }*/
                                
                                //alert(ol.proj.transform(evt.coordinate,'EPSG:3857', 'EPSG:4326'));
                                
                                //alert("overlays --> "+map.getOverlays());
                                
                            });      
                            
                            $(document).keypress(function(e)
                            {   
                                if(window.location.hash=="#/simulator"){
                                    switch(e.which)
                                    {
                                        case 119: //es la w. Significa arriba
                                            up(); 
                                            break;
                                        case 115: //es la s. Significa abajo
                                            down(); 
                                            break;  
                                        case 97: //es la a. Significa izq  
                                            left(); 
                                            break; 
                                        case 100: //es la d. Signfica dcha
                                            right(); 
                                            break;
                                    }
                                }
                            });
                            
                            function up(){
                                alert("up");
                            }
                            
                            function down(){
                                alert("down");
                            }
                            
                            function left(){
                                alert("left");
                            }
                            
                            function right(){
                                alert("right");
                            }
                            
                            function getImg(){
                                return getScope().userImg;
                            }
                            
                            function getUser(){
                                return getScope().getUser();
                            }
                            
                            function getScope(){
                                var appElement = document.querySelector('[ng-app=app]');
                                var $scope = angular.element(appElement).scope();
                                return $scope.$$childHead;
                            }
                            
                            /*var exportPNGElement = document.getElementById('export-png');
                            if ('download' in exportPNGElement) {
                                exportPNGElement.addEventListener('click', function(e) {
                                    map.once('postcompose', function(event) {
                                        var canvas = event.context.canvas;
                                        //exportPNGElement.href = canvas.toDataURL('image/png');
                                        document.getElementById('captura').src=canvas.toDataURL('image/png');
                                    });
                                    map.renderSync();
                                }, false);
                            } else {
                                var info = document.getElementById('no-download');
                                info.style.display = '';
                            }           */                  
                        </script>
                    
                    <div class="col-sm-4">
                        <button type="button" class="btn btn-default fa fa-play-circle-o" ng-click="getUser()">                         
                        </button>
                        
                        <button type="button" class="btn btn-default fa fa-pause">                         
                        </button>
                        
                        <button type="button" class="btn btn-default fa fa-stop">                         
                        </button>
                        
                        <button type="button" class="btn btn-default fa fa-download">                         
                        </button>
                            
                        <button type="button" class="btn btn-default fa fa-arrow-up" onclick="up()">                         
                        </button>

                        <button type="button" class="btn btn-default fa fa-arrow-down" hidden="hidden" onclick="down()">                         
                        </button>
                        
                        <button type="button" class="btn btn-default fa fa-arrow-left" onclick="left()">                         
                        </button>
                 
                        <button type="button" class="btn btn-default fa fa-arrow-right" onclick="right()">                         
                        </button>
                    
                        
                         <!-- <a id="export-png" class="btn" download="map.png"><i class="icon-download"></i> Export PNG</a> 
                        <br/>
                        <img id="captura" style="height: 50%;width: 50%;">
                          <!-- Table -->
                          
                        <table class="table">
                            <tbody>
                                <tr>
                                    <th scope="row">1</th>
                                    <td>Bar numero 1</td>
                                    <td>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star"></div>
                                    </td>
                                    <td>
                                        <select>
                                            <option value="0"></option>
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                        </select>
                                    </td>
                                </tr>

                                <tr>
                                    <th scope="row">2</th>
                                    <td>Restaurante num 1</td>
                                    <td>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star"></div>
                                    </td>
                                    <td>
                                        <select>
                                            <option value="0"></option>
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                        </select>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <th scope="row">3</th>
                                    <td>Larry</td>
                                    <td>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star-half"></div>
                                    </td>
                                    <td>
                                        <select>
                                            <option value="0"></option>
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                        </select>
                                    </td>
                                </tr> 
                                
                                <tr>
                                    <th scope="row">4</th>
                                    <td>Bar numero 1</td>
                                    <td>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star-half"></div>
                                    </td>
                                    <td>
                                        <select>
                                            <option value="0"></option>
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                        </select>
                                    </td>
                                </tr>

                                <tr>
                                    <th scope="row">5</th>
                                    <td>Restaurante num 1</td>
                                    <td>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star-o"></div>
                                    </td>
                                    <td>
                                        <select>
                                            <option value="0"></option>
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                        </select>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <th scope="row">6</th>
                                    <td>Larry</td>
                                    <td>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star-o"></div>
                                    </td>
                                    <td>
                                        <select>
                                            <option value="0"></option>
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                        </select>
                                    </td>
                                </tr> 
                                
                                
                                <tr>
                                    <th scope="row">7</th>
                                    <td>Bar numero 1</td>
                                    <td>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star-half"></div>
                                        <div class="fa fa-star-o"></div>
                                        <div class="fa fa-star-o"></div>
                                    </td>
                                    <td>
                                        <select>
                                            <option value="0"></option>
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                        </select>
                                    </td>
                                </tr>

                                <tr>
                                    <th scope="row">8</th>
                                    <td>Restaurante num 1</td>
                                    <td>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star-o"></div>
                                        <div class="fa fa-star-o"></div>
                                        <div class="fa fa-star-o"></div>
                                    </td>
                                    <td>
                                        <select>
                                            <option value="0"></option>
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                        </select>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <th scope="row">9</th>
                                    <td>Larry</td>
                                    <td>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star-half"></div>
                                        <div class="fa fa-star-o"></div>
                                        <div class="fa fa-star-o"></div>
                                        <div class="fa fa-star-o"></div>
                                    </td>
                                    <td>
                                        <select>
                                            <option value="0"></option>
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                        </select>
                                    </td>
                                </tr>
                                
                                <tr>
                                    <th scope="row">10</th>
                                    <td>Bar numero 1</td>
                                    <td>
                                        <div class="fa fa-star"></div>
                                        <div class="fa fa-star-half"></div>
                                        <div class="fa fa-star-o"></div>
                                        <div class="fa fa-star-o"></div>
                                        <div class="fa fa-star-o"></div>
                                    </td>
                                    <td>
                                        <select>
                                            <option value="0"></option>
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                        </select>
                                    </td>
                                </tr>
        
                            </tbody>
                        </table>    
                       
                        <div class="row">
                            <div class="">
                                <div class="col-xs-6">
                                    <label>User speed (km/h)</label>
                                    <input class="form-control" value="5"/>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>							
            </div>            
        </div>
    </div>